{% extends 'home.html' %}

{% block page_background %}
{% load static %}
<div class="salary-page">
  <!-- Header Section -->
  <div class="header-container">
    <h2 class="header-title">L∆∞∆°ng c·ªßa: {{ nhan_vien.ten_nv }}</h2>

    <div class="header-actions">
    </div>
  </div>

  <!-- Main Container with Columns -->
  <div class="container">
    <!-- Left Column: Salary Tables -->
    <div class="salary-column">
      <div class="salary-wrapper">
        {% for bang_luong in bang_luong_list %}
          <div id="bang_luong_{{ forloop.counter }}" class="salary-block">
            <h3 class="salary-title">B·∫£ng L∆∞∆°ng {{ bang_luong.title }}</h3>

            <table class="salary-table">
              <thead>
                <tr>
                  <th>H·∫°ng m·ª•c</th>
                  <th>Gi√° tr·ªã (VND)</th>
                </tr>
              </thead>
              <tbody>
                <tr class="base-row">
                  <td>L∆∞∆°ng c∆° b·∫£n</td>
                  <td class="amount">{{ bang_luong.muc_luong|floatformat:0 }}</td>
                </tr>
                <tr class="deduction-row">
                  <td>Ti·ªÅn BHXH</td>
                  <td class="amount">{{ bang_luong.tien_bhxh|default:0|floatformat:0 }}</td>
                </tr>
                <tr class="deduction-row">
                  <td>Thu·∫ø</td>
                  <td class="amount">{{ bang_luong.thue|floatformat:0 }}</td>
                </tr>
                <tr class="deduction-row">
                  <td>K·ª∑ lu·∫≠t</td>
                  <td class="amount">{{ bang_luong.tien_ky_luat|floatformat:0 }}</td>
                </tr>
                <tr class="addition-row">
                  <td>Th∆∞·ªüng</td>
                  <td class="amount">{{ bang_luong.thuong|floatformat:0 }}</td>
                </tr>
                <tr class="deduction-row">
                  <td>Tr·ª´ v·∫Øng</td>
                  <td class="amount">{{ bang_luong.vang_tru|floatformat:0 }}</td>
                </tr>
                <tr class="deduction-row">
                  <td>Tr·ª´ mu·ªôn</td>
                  <td class="amount">{{ bang_luong.muon_tru|floatformat:0 }}</td>
                </tr>
                <tr class="addition-row">
                  <td>Ph·ª• c·∫•p chuy√™n c·∫ßn</td>
                  <td class="amount">{{ bang_luong.phu_cap_chuyen_can|floatformat:0 }}</td>
                </tr>
                <tr class="addition-row">
                  <td>Ph·ª• c·∫•p kh√°c</td>
                  <td class="amount">{{ bang_luong.tong_phu_cap|default:0|floatformat:0 }}</td>
                </tr>
                <tr class="total-row">
                  <td>T·ªïng l∆∞∆°ng</td>
                  <td class="amount total">{{ bang_luong.tong_luong|floatformat:0 }}</td>
                </tr>
              </tbody>
            </table>

            <div class="salary-summary">
              <div class="summary-item">
                <span class="summary-label">T·ªïng kh·∫•u tr·ª´:</span>
                <span class="summary-value deduction">
                  {{ bang_luong.tien_bhxh|default:0|add:bang_luong.thue|add:bang_luong.tien_ky_luat|add:bang_luong.vang_tru|add:bang_luong.muon_tru|floatformat:0 }} VND
                </span>
              </div>
              <div class="summary-item">
                <span class="summary-label">T·ªïng c·ªông th√™m:</span>
                <span class="summary-value addition">
                  {{ bang_luong.thuong|add:bang_luong.phu_cap_chuyen_can|add:bang_luong.tong_phu_cap|default:0|floatformat:0 }} VND
                </span>
              </div>
            </div>
          </div>
        {% empty %}
          <div class="empty-state">
            <div class="empty-icon">üìä</div>
            <p>Kh√¥ng c√≥ b·∫£ng l∆∞∆°ng n√†o.</p>
          </div>
        {% endfor %}
      </div>
    </div>

    <!-- Right Column: Filters -->
    <div class="filter-column">
      <div class="filter-card">
        <h3 class="filter-title">B·ªô l·ªçc</h3>

        <div class="filter-group">
          <label for="month_select">Th√°ng</label>
          <select id="month_select" class="filter-select">
            <option value="">Ch·ªçn th√°ng</option>
            {% for i in "123456789101112"|make_list %}
              <option value="{{ i }}">Th√°ng {{ i }}</option>
            {% endfor %}
          </select>
        </div>

        <div class="filter-group">
          <label for="year_select">NƒÉm</label>
          <select id="year_select" class="filter-select">
            <option value="">Ch·ªçn nƒÉm</option>
            {% for y in years %}
              <option value="{{ y }}">{{ y }}</option>
            {% endfor %}
          </select>
        </div>

        <button onclick="scrollToSalary()" class="filter-button">
          <svg class="button-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
          </svg>
          Xem b·∫£ng l∆∞∆°ng
        </button>
      </div>

      <div class="summary-card">
        <h3 class="summary-title">T·ªïng quan</h3>
        <div class="summary-stats">


          {% if bang_luong_list %}
          <div class="stat-item">
            <div class="stat-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
              </svg>
            </div>
            <div class="stat-details">
              <div class="stat-value">{{ bang_luong_list.0.tong_luong|floatformat:0 }}</div>
              <div class="stat-label">L∆∞∆°ng g·∫ßn nh·∫•t</div>
            </div>
          </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Link to external CSS file -->
<link rel="stylesheet" href="{% static 'css/danh_sach_luong.css' %}">

<!-- JavaScript for interactivity -->
<script>
function scrollToSalary() {
  const month = document.getElementById("month_select").value;
  const year = document.getElementById("year_select").value;

  if (!month || !year) {
    alert("Vui l√≤ng ch·ªçn ƒë·∫ßy ƒë·ªß th√°ng v√† nƒÉm.");
    return;
  }

  // Find the salary table that matches the month and year
  // This is a simplified example - you would need to adjust based on your actual data structure
  const targetId = `bang_luong_${month}`;
  const target = document.getElementById(targetId);

  if (target) {
    target.scrollIntoView({ behavior: 'smooth' });
    target.classList.add('highlight');
    setTimeout(() => {
      target.classList.remove('highlight');
    }, 2000);
  } else {
    alert("Kh√¥ng t√¨m th·∫•y b·∫£ng l∆∞∆°ng cho th·ªùi gian ƒë√£ ch·ªçn.");
  }
}
</script>
{% endblock %}