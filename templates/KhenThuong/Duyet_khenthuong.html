{% extends 'home.html' %}
{% load static %}

{% block page_background %}
<main class="p-4" style="flex-grow: 1; background-color: white; align-items: flex-start;">
    <div class="container">
        <div style="background: white; border-radius: 15px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); padding: 20px;">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <a href="{% url 'ky_luat_khen_thuong' %}" class="btn btn-secondary"
                   style="background-color: #e0e0e0; border: none; border-radius: 20px; padding: 10px 20px; font-size: 14px; color: #333; display: inline-flex; align-items: center; gap: 8px; transition: all 0.3s;">
                    <i class="fas fa-arrow-left" style="font-size: 12px;"></i> Quay lại
                </a>
            </div>
            <div class="row justify-content-center">
                <div class="col-md-8">
                    <div class="p-4" style="background: linear-gradient(to right, #ddf0ff, #ffffff); box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);">
                        <div class="d-flex justify-content-center align-items-center mb-4">
                            <h2 class="fw-bold">DUYỆT ĐƠN KHEN THƯỞNG</h2>
                        </div>
                        <div class="row">
                            <div class="col-12">
                                <p><strong style="color: #3A7DB8;">Mã nhân viên:</strong> <strong style="font-size: 18px;">{{ khen_thuong.nhan_vien.user_id }}</strong></p>
                                <p><strong style="color: #3A7DB8;">Tên nhân viên:</strong> <strong style="font-size: 18px;">{{ khen_thuong.nhan_vien.ten_nv }}</strong></p>
                                <p class="mb-2"><span class="fw-bold" style="color: #3A7DB8;">Ngày ra quyết định:</span> {{ khen_thuong.ngay_tao|date:"d/m/Y H:i" }}</p>
                                <p class="mb-CL2"><span class="fw-bold" style="color: #3A7DB8;">Giá trị:</span> {{ khen_thuong.gia_tri }} VNĐ</p>
                                <p class="mb-2"><span class="fw-bold" style="color: #3A7DB8;">Người tạo:</span> {{ khen_thuong.nguoi_tao_don.ten_nv }} ({{ khen_thuong.nguoi_tao_don.chuc_vu|default:'N/A' }})</p>
                                <p class="mb-2"><span class="fw-bold" style="color: #3A7DB8;">Người được chỉ định duyệt:</span> {{ khen_thuong.nguoi_xac_nhan.ten_nv|default:"Chưa chỉ định" }} {% if khen_thuong.nguoi_xac_nhan %}({{ khen_thuong.nguoi_xac_nhan.chuc_vu|default:'N/A' }}){% endif %}</p>
                                <p class="mb-2"><span class="fw-bold" style="color: #3A7DB8;">Trạng thái:</span> {{ khen_thuong.get_trang_thai_display }}</p>
                                <p class="mb-2">
                                    <span class="fw-bold" style="color: #3A7DB8;">Minh chứng:</span>
                                    {% if khen_thuong.minh_chung_file %}
                                        <a href="{{ khen_thuong.minh_chung_file.url }}" target="_blank">Xem file</a>
                                    {% elif khen_thuong.minh_chung_url %}
                                        <a href="{{ khen_thuong.minh_chung_url }}" target="_blank">Xem URL</a>
                                    {% else %}
                                        Không có
                                    {% endif %}
                                </p>
                                <p><strong style="color: #3A7DB8;">Lý do:</strong> {{ khen_thuong.ly_do }}</p>
                            </div>
                        </div>
                        {% if khen_thuong.trang_thai == 'DANG_CHO_DUYET' %}
                        <form method="post">
                            {% csrf_token %}
                            <div class="d-flex justify-content-end mt-4">
                                <button type="submit" name="action" value="approve" class="btn btn-success me-2" style="border-radius: 15px; padding: 8px 30px; font-size: 16px;">
                                    Duyệt
                                </button>
                                <button type="submit" name="action" value="reject" class="btn btn-danger" style="border-radius: 15px; padding: 8px 30px; font-size: 16px;">
                                    Từ chối
                                </button>
                            </div>
                        </form>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>
{% endblock %}